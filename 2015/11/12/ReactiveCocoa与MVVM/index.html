<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>ReactiveCocoa学习总结 | 潮汐</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="初衷  最近刚开发完一款公司的ipad应用，有两个界面的网络请求都达到了十个以上，在控件的创建约束都是由xib来完成的情况下，试图控制器中的代码都达到了1400多行。业务逻辑处理非常混乱，数据和视图之间高度偶耦合。虽然所有功能需求都能实现，但代码的可读性非常差，以后的迭代肯定也非常麻烦。所以趁不忙的时候打算着手研究一下MVVM与ReactiveCocoa。这篇博客会一直记录最近的所学。  基本理">
<meta name="keywords" content="学习笔记">
<meta property="og:type" content="article">
<meta property="og:title" content="ReactiveCocoa学习总结">
<meta property="og:url" content="http://chaoxn.com/2015/11/12/ReactiveCocoa与MVVM/index.html">
<meta property="og:site_name" content="潮汐">
<meta property="og:description" content="初衷  最近刚开发完一款公司的ipad应用，有两个界面的网络请求都达到了十个以上，在控件的创建约束都是由xib来完成的情况下，试图控制器中的代码都达到了1400多行。业务逻辑处理非常混乱，数据和视图之间高度偶耦合。虽然所有功能需求都能实现，但代码的可读性非常差，以后的迭代肯定也非常麻烦。所以趁不忙的时候打算着手研究一下MVVM与ReactiveCocoa。这篇博客会一直记录最近的所学。  基本理">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://raw.githubusercontent.com/chaoxn/OSS/master//FRP_ReactiveCocoa_large.png">
<meta property="og:updated_time" content="2019-12-24T02:15:59.859Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ReactiveCocoa学习总结">
<meta name="twitter:description" content="初衷  最近刚开发完一款公司的ipad应用，有两个界面的网络请求都达到了十个以上，在控件的创建约束都是由xib来完成的情况下，试图控制器中的代码都达到了1400多行。业务逻辑处理非常混乱，数据和视图之间高度偶耦合。虽然所有功能需求都能实现，但代码的可读性非常差，以后的迭代肯定也非常麻烦。所以趁不忙的时候打算着手研究一下MVVM与ReactiveCocoa。这篇博客会一直记录最近的所学。  基本理">
<meta name="twitter:image" content="https://raw.githubusercontent.com/chaoxn/OSS/master//FRP_ReactiveCocoa_large.png">
  
    <link rel="alternative" href="/atom.xml" title="潮汐" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="https://raw.githubusercontent.com/chaoxn/OSS/master/1.pic.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">潮汐</a></h1>
		</hgroup>

		
		<p class="header-subtitle">你梦想蓝图的每一个像素，都得你用才华和汗水填补。</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">首页</a></li>
				        
							<li><a href="/archives">文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/chaoxn" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="/“#”" title="weibo">weibo</a>
					        
								<a class="google" target="_blank" href="#" title="google">google</a>
					        
								<a class="twitter" target="_blank" href="https://twitter.com/chaoxn" title="twitter">twitter</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/Android/" style="font-size: 16.67px;">Android</a> <a href="/tags/Git/" style="font-size: 10px;">Git</a> <a href="/tags/Xcode/" style="font-size: 10px;">Xcode</a> <a href="/tags/iCoud/" style="font-size: 10px;">iCoud</a> <a href="/tags/iOS10/" style="font-size: 10px;">iOS10</a> <a href="/tags/iOS12/" style="font-size: 10px;">iOS12</a> <a href="/tags/iOS9/" style="font-size: 13.33px;">iOS9</a> <a href="/tags/xcode/" style="font-size: 10px;">xcode</a> <a href="/tags/学习笔记/" style="font-size: 20px;">学习笔记</a> <a href="/tags/随笔/" style="font-size: 16.67px;">随笔</a>
					</div>
				</section>
				
				
				

				
				
				<section class="switch-part switch-part3">
				
					<div id="js-aboutme">我就是我</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">潮汐</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="https://raw.githubusercontent.com/chaoxn/OSS/master/1.pic.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">潮汐</h1>
			</hgroup>
			
			<p class="header-subtitle">你梦想蓝图的每一个像素，都得你用才华和汗水填补。</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">首页</a></li>
		        
					<li><a href="/archives">文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/chaoxn" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="/“#”" title="weibo">weibo</a>
			        
						<a class="google" target="_blank" href="#" title="google">google</a>
			        
						<a class="twitter" target="_blank" href="https://twitter.com/chaoxn" title="twitter">twitter</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap"><article id="post-ReactiveCocoa与MVVM" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/11/12/ReactiveCocoa与MVVM/" class="article-date">
  	<time datetime="2015-11-12T08:39:54.000Z" itemprop="datePublished">2015-11-12</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      ReactiveCocoa学习总结
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/学习笔记/">学习笔记</a></li></ul>
	</div>

        

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p></p><p></p>
<font color="orangeRed" size="4">初衷</font>

<p>最近刚开发完一款公司的ipad应用，有两个界面的网络请求都达到了十个以上，在控件的创建约束都是由xib来完成的情况下，试图控制器中的代码都达到了1400多行。业务逻辑处理非常混乱，数据和视图之间高度偶耦合。虽然所有功能需求都能实现，但代码的可读性非常差，以后的迭代肯定也非常麻烦。所以趁不忙的时候打算着手研究一下MVVM与ReactiveCocoa。这篇博客会一直记录最近的所学。</p>
<p></p><p></p>
<font color="orangeRed" size="4">基本理解</font>

<p>看了两天的各种博客和<a href="https://github.com/ReactiveCocoa/ReactiveCocoa" target="_blank" rel="external">官方介绍</a>也只是对其有了一个大概的了解：它是一个iOS开发中常用的各种delegate，KVO，通知 action，netReuquest的集合。说白了也就是有了RAC那些你都不需要了。RAC主要的思想是函数式编程和响应式编程。</p>
<a id="more"></a>
<p><ul><li><a href="https://en.wikipedia.org/wiki/Functional_programming" target="_blank" rel="external">函数式编程<a></a></a></li></ul>主要思想是把运算过程尽量写成一系列嵌套的函数调用</p>
<p>比如我们有这么一个算数<br><figure class="highlight basic"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">1 </span>*(<span class="number">2</span> + <span class="number">3</span>)-<span class="number">4</span></div></pre></td></tr></table></figure></p>
<p>一般的编程思维是<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">var a = <span class="number">2</span> + <span class="number">3</span></div><div class="line">var b = a * <span class="number">1</span></div><div class="line">var c = b - <span class="number">4</span></div></pre></td></tr></table></figure></p>
<p>而函数编程<br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">var result = subtract (<span class="name">multiply</span> (<span class="name">add</span> (<span class="number">2</span> + <span class="number">3</span>)，<span class="number">1</span>) ，<span class="number">4</span>)</div></pre></td></tr></table></figure></p>
<p>简单来说就是把函数当作另一个函数的参数。<br></p>
<p><ul><li><a href="https://en.wikipedia.org/wiki/Reactive_programming" target="_blank" rel="external">响应式编程<a></a></a></li></ul>响应式是这样的一个思路：你可以给几乎所有事物创建数据流。数据流无处不在，任何东西都可以成为一个数据流，例如变量、用户输入、属性、缓存、数据结构等等。举个栗子，你可以把你的微博订阅功能想象成跟点击事件一样的数据流，你可以监听这样的数据流，并做出相应的反应。在RAC中信号(RACSignal)可以表现为数据流，我们需要把信号与事物绑定。然后监听这个信号。</p>
<p>比如<br><figure class="highlight ini"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="attr">a</span> = <span class="number">2</span></div><div class="line"><span class="attr">b</span> = <span class="number">2</span></div><div class="line"><span class="attr">c</span> = a + b</div></pre></td></tr></table></figure></p>
<p>其实就是将a，b的值与c绑定，c监听a，b值的变化，只要a，b发生变化c就随之变化<br><br></p>
<font color="orangeRed" size="4"><strong>常见的类</strong></font><br>因为现在刚刚学习，接触到的类也不是很多，简单介绍以下目前了解的类。会陆续更新.<br><font color="darkslateblue" size="3"><strong>1. RACSignal（信号类）：</strong></font>  Signal是RAC中的核心概念。当数据改变时，信号内部就会收到数据，然后发出。<strong>但是默认一个信号是冷信号</strong>，当一个信号没有订阅者（Subscriber）时它什么也不干，就像我们的函数，当一个函数写好之后并没有被调用它也什么都不会干。信号可以通过以下三种方式发送事件给订阅者。<br><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[<span class="keyword">subscriber </span>sendNext:@<span class="string">"接收到的数据"</span>]；</div><div class="line">[<span class="keyword">subscriber </span>sendComplete]<span class="comment">;</span></div><div class="line">[<span class="keyword">subscriber </span>sendError]<span class="comment">;</span></div></pre></td></tr></table></figure><br><br>分别是发送，发送完成，发送中的错误，sunscriber可以多次sendNext，但只能有一次sendComplete或sendError。<br>下面举个例子说明一下<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//这是一个标准的冷信号，创建好之后发送方法也准备就绪，但并没有被订阅，所以现在处于cold状态。</span></div><div class="line">RACSignal *testSignal = [RACSignal createSignal:^RACDisposable *(<span class="keyword">id</span>&lt;RACSubscriber&gt; subscriber) &#123;</div><div class="line">    <span class="comment">// 每当有订阅者订阅这个信号 才会执行          </span></div><div class="line">    [subscriber sendNext:<span class="string">@"biubiu"</span>];</div><div class="line">    [subscriber sendCompleted];</div><div class="line">    <span class="keyword">return</span> <span class="literal">nil</span>；   </div><div class="line">&#125;];</div><div class="line"> </div><div class="line"><span class="comment">//现在这个信号被调用了，发送的“biubiu”已经被x所接收。</span></div><div class="line">[testSignal subscribeNext:^(<span class="keyword">id</span> x) &#123;</div><div class="line">      <span class="comment">//收到信号发送过来的值</span></div><div class="line">      <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, x);</div><div class="line">&#125;];</div></pre></td></tr></table></figure><br><br><font color="darkslateblue" size="3"><strong>2. RACSubject（可变的信号）：</strong></font> 可以连接RAC代码与非RAC代码，可以接收和主动发送信号。看了很多介绍都不推荐使用。目前我只把他当作代理使用了一下。<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">第一步：在第二个界面创建代理信号属性</div><div class="line">        <span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) RACSubject *delegateSignal;        </div><div class="line">第二步：监听某个值的变化 我在这里监听了这个界面的model。(RACCommadn之后介绍)   </div><div class="line">        [_requestCommand.executionSignals.switchToLatest subscribeNext:^(<span class="keyword">id</span> model) &#123;</div><div class="line">          <span class="keyword">if</span> (<span class="keyword">self</span>.delegateSignal) &#123;</div><div class="line">               [<span class="keyword">self</span>.delegateSignal sendNext:model];</div><div class="line">          &#125;</div><div class="line">    	&#125;]; 		</div><div class="line">第三步：在第一个界面创建第二个界面并设置代理信号然后订阅</div><div class="line">         <span class="keyword">self</span>.viewModel.delegateSignal = [RACSubject subject];</div><div class="line">    	 [<span class="keyword">self</span>.viewModel.delegateSignal subscribeNext:^(<span class="keyword">id</span> model) &#123;</div><div class="line">             <span class="keyword">self</span>.model = model;</div><div class="line">&#125;];</div></pre></td></tr></table></figure><br><br><font color="darkslateblue" size="3"><strong>3.RACCommand（处理事件的类）：</strong></font> 监控了事件的整个处理过程。对事件如何处理和其中数据的传递都做了处理。还是直接上代码：<br><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">第一步：创建命令，命令里必须要返回一个信号，如果不想返回可以返回一个空信号（[RACSignal empty]），然后在命令里创建信号，来传输数据，可以是这个命令接收到的也可以是任意的。</div><div class="line">	RACCommand *command = [[RACCommand alloc]initWithSignalBlock:^RACSignal *(id input) &#123;   </div><div class="line">    RACSignal *signal = [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; <span class="keyword">subscriber) </span>&#123;</div><div class="line">      [<span class="keyword">subscriber </span>sendNext:input]<span class="comment">;</span></div><div class="line">      [<span class="keyword">subscriber </span>sendCompleted]<span class="comment">;</span></div><div class="line">      return nil<span class="comment">;</span></div><div class="line">    &#125;]；       </div><div class="line">  return signal<span class="comment">;</span></div><div class="line">&#125;]<span class="comment">;</span></div><div class="line">第二步：接收命令里的信号中的数据</div><div class="line">[command.executionSignals.<span class="keyword">switchToLatest </span><span class="keyword">subscribeNext:^(id </span>x) &#123;   </div><div class="line">   NSLog(@<span class="string">"%@"</span>, x)<span class="comment">;</span></div><div class="line">&#125;]<span class="comment">;</span></div><div class="line">第三步：执行这个命令，如果在这里不想传输什么可以传nil</div><div class="line">[command execute:@<span class="string">"执行"</span>]<span class="comment">;      </span></div><div class="line">以上三步就是一个完整的command命令流程，这个方法是用来监听命令执行过程中的状态</div><div class="line">[command.executing <span class="keyword">subscribeNext:^(id </span>x) &#123;         </div><div class="line">	if ([x <span class="keyword">boolValue] </span>== YES) &#123;  </div><div class="line">       NSLog(@<span class="string">"正在执行"</span>)<span class="comment">;</span></div><div class="line">	 &#125;else&#123;</div><div class="line">       NSLog(@<span class="string">"尚未执行"</span>)<span class="comment">;</span></div><div class="line">       &#125;</div><div class="line">&#125;]<span class="comment">;</span></div><div class="line">log一下，可以看到整个流程</div><div class="line"><span class="number">2015</span>-11-12 <span class="number">14</span>:<span class="number">19</span>:<span class="number">50</span>.<span class="number">373</span> chaoxi[<span class="number">62340</span>:<span class="number">6653950</span>] 尚未执行</div><div class="line"><span class="number">2015</span>-11-12 <span class="number">14</span>:<span class="number">19</span>:<span class="number">50</span>.<span class="number">389</span> chaoxi[<span class="number">62340</span>:<span class="number">6653950</span>] 正在执行</div><div class="line"><span class="number">2015</span>-11-12 <span class="number">14</span>:<span class="number">19</span>:<span class="number">50</span>.<span class="number">390</span> chaoxi[<span class="number">62340</span>:<span class="number">6653950</span>] 执行</div></pre></td></tr></table></figure><br><br><font color="darkslateblue" size="3"><strong>4.RACTuple（元组类）：</strong></font>用来包装值，下面RACSequence中会用到。<br>    具体介绍可以参考<a href="http://cocoadocs.org/docsets/ReactiveCocoa/2.3.1/Classes/RACTuple.html" target="_blank" rel="external">这篇文章</a><br><br><font color="darkslateblue" size="3"><strong>5.RACSequence（集合类）：</strong></font>RAC中的NSArray，NSDictionary，可以通过rac_sequence方法使NSArry转换为RACSequence。但是传闻ReactiveCocoa3中将会废弃sequences。所以就简单了解下它的基本操作：<br><font color="red" size="3">遍历数组：</font><br><font color="seagreen" size="3">创建一个数组然后通过rac_sequence操作转换为RACSequence然后订阅信号就会把集合中的所有值遍历</font>

<figure class="highlight dns"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">NSArray *array = @[@"<span class="number">1</span>", @"<span class="number">3</span>", @"<span class="number">5</span>", @"<span class="number">7</span>"]<span class="comment">;</span></div><div class="line">RACSequence *sequence = [array rac_sequence]<span class="comment">; </span></div><div class="line">    [sequence.signal subscribeNext:^(id x) &#123;</div><div class="line">  	NSLog(@"%@", x)<span class="comment">;</span></div><div class="line">&#125;]<span class="comment">;</span></div><div class="line"></div><div class="line">打印结果如下</div><div class="line"><span class="number">2015-11-12</span> <span class="number">15</span>:<span class="number">03:35.875</span> chaoxi[<span class="number">62641</span>:<span class="number">6697530</span>] <span class="number">1</span></div><div class="line"><span class="number">2015-11-12</span> <span class="number">15</span>:<span class="number">03:35.875</span> chaoxi[<span class="number">62641</span>:<span class="number">6697530</span>] <span class="number">3</span></div><div class="line"><span class="number">2015-11-12</span> <span class="number">15</span>:<span class="number">03:35.875</span> chaoxi[<span class="number">62641</span>:<span class="number">6697530</span>] <span class="number">5</span></div><div class="line"><span class="number">2015-11-12</span> <span class="number">15</span>:<span class="number">03:35.876</span> chaoxi[<span class="number">62641</span>:<span class="number">6697530</span>] <span class="number">7</span></div></pre></td></tr></table></figure>
<font color="red" size="3">遍历字典：</font>

<font color="seagreen" size="3">创建一个字典然后通过rac_sequence操作转换为RACSequence遍历，遍历的结果位RACTuple元组，然后把元组解包给参数里面变量赋值</font>

<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">NSDictionary *<span class="keyword">dictonary </span>= @&#123;@<span class="string">"title"</span>:@<span class="string">"RAC"</span>,@<span class="string">"auther"</span>:@<span class="string">"潮汐"</span>&#125;<span class="comment">;</span></div><div class="line">    </div><div class="line">RACSequence *dSequence = [<span class="keyword">dictonary </span>rac_sequence]<span class="comment">;</span></div><div class="line">    </div><div class="line">[dSequence.signal <span class="keyword">subscribeNext:^(RACTuple </span>*x) &#123;</div><div class="line">       </div><div class="line">   RACTupleUnpack(NSString *key, NSString *value) = x<span class="comment">;</span></div><div class="line">        </div><div class="line">   NSLog(@<span class="string">"%@, %@"</span>,key,value)<span class="comment">;</span></div><div class="line"> &#125;]<span class="comment">;</span></div><div class="line"> </div><div class="line">打印结果如下</div><div class="line"><span class="number">2015</span>-11-12 <span class="number">15</span>:<span class="number">18</span>:<span class="number">38</span>.<span class="number">108</span> chaoxi[<span class="number">63381</span>:<span class="number">6753990</span>] title, RAC</div><div class="line"><span class="number">2015</span>-11-12 <span class="number">15</span>:<span class="number">18</span>:<span class="number">38</span>.<span class="number">110</span> chaoxi[<span class="number">63381</span>:<span class="number">6753990</span>] auther, 潮汐</div></pre></td></tr></table></figure>
<p><font color="darkslateblue" size="3"><strong>6.其他：</strong></font> 还有很多类似RACScheduler的信号我还没有了解到，这里就不做详细介绍</p>
<p>这是摘自花瓣网工程师博客的一幅图，可以直观的看到各个类之间的关系<br><img src="https://raw.githubusercontent.com/chaoxn/OSS/master//FRP_ReactiveCocoa_large.png" alt="t"></p>
<p><br><font color="orangeRed" size="4"><strong>常用的Category</strong></font><br><br>上面简单介绍了一些基本类，而RAC本身也通过Category为UIKit的很多基本控件添加了很多的Signal，方便我们直接的订阅信号。接下来介绍一些常用的Category。</p>
<ol>
<li><p><strong>TextField：</strong> rac_textSignal 直接绑定在TextField上的信号，可以实时监听TF上输入的内容。然后进行过滤判断等操作。</p>
<figure class="highlight hy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[textField.rac_textSignal subscribeNext:^(<span class="name"><span class="builtin-name">id</span></span> x)&#123;</div><div class="line"></div><div class="line">  	NSLog(@<span class="string">"%@"</span>, x)<span class="comment">;</span></div><div class="line">&#125;]<span class="comment">;</span></div></pre></td></tr></table></figure>
</li>
<li><p><strong>UIButton:</strong> rac_command 每当按钮被点击的时候执行这个命令然后返回一个信号，可以根据信号来做一些我们想做的事情。</p>
<figure class="highlight hsp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">button.rac_command = [[RACCommand <span class="keyword">alloc</span>]initWithSignalBlock:^RACSignal *(id <span class="keyword">input</span>) &#123;</div><div class="line"></div><div class="line">    <span class="comment">// 里面的使用和RACCommand就大同小异了</span></div><div class="line">&#125;]<span class="comment">;</span></div></pre></td></tr></table></figure>
</li>
<li><p><strong>UIAlterView:</strong> rac_buttonClickedSignal alterView的Signal使我们省去了delegate</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">UIAlertView *alertView = [[UIAlertView alloc] <span class="string">initWithTitle:</span>@<span class="string">""</span> <span class="string">message:</span>@<span class="string">"Alert"</span> <span class="string">delegate:</span>nil <span class="string">cancelButtonTitle:</span>@<span class="string">"YES"</span> <span class="string">otherButtonTitles:</span>@<span class="string">"NO"</span>, nil];</div><div class="line">[[alertView rac_buttonClickedSignal] <span class="string">subscribeNext:</span>^(<span class="keyword">int</span> index) &#123;</div><div class="line"></div><div class="line">  	<span class="comment">// 通过index做出不同点击事件的处理</span></div><div class="line">&#125;];</div><div class="line">[alertView show];</div></pre></td></tr></table></figure>
</li>
</ol>
<p><font color="brown" size="3"><strong>下面这几个暂时还没用过，记录一下慢慢研究</strong></font></p><p></p>
<ol>
<li><p><strong>NSNotificationCenter：</strong> rac_addObserverForName</p>
<figure class="highlight prolog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">[[[<span class="symbol">NSNotificationCenter</span> defaultCenter] rac_addObserverForName:@<span class="string">"NSNotificationCenter"</span> object:nil]subscribeNext:^(<span class="symbol">NSNotification</span>* x)&#123;</div><div class="line"></div><div class="line">	<span class="symbol">NSLog</span>(@<span class="string">"author：%@"</span>, x.userInfo[@<span class="string">"author"</span>]);</div><div class="line">&#125;];</div><div class="line"></div><div class="line">[[<span class="symbol">NSNotificationCenter</span> defaultCenter] postNotificationName:@<span class="string">"NSNotificationCenter"</span> object:nil userInfo:@&#123;@<span class="string">"author"</span>:@<span class="string">"chaoxi"</span>&#125;];</div><div class="line"></div><div class="line">log日志</div><div class="line"><span class="number">2015</span><span class="number">-11</span><span class="number">-13</span> <span class="number">11</span>:<span class="number">15</span>:<span class="number">04.538</span> chaoxi[<span class="number">65891</span>:<span class="number">7195142</span>] auther, 潮汐</div></pre></td></tr></table></figure>
</li>
<li><p><strong>NSObject：</strong> rac_willDeallocSignal 在一个对象的dealloc触发的时候调用</p>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">NSArray *array = @[@<span class="string">"array"</span>];</div><div class="line">[[array rac_willDeallocSignal] subscribeCompleted:^&#123;</div><div class="line"></div><div class="line">     NSLog(@<span class="string">"boo,"</span>);</div><div class="line">&#125;];</div><div class="line"></div><div class="line">array = nil;</div><div class="line"></div><div class="line">log日志</div><div class="line">2015-11-13 11:15:24.687 chaoxi[65926:7195996] boom!!&gt;</div></pre></td></tr></table></figure>
</li>
</ol>
<p><br><font color="orangeRed" size="4"><strong>常用的宏</strong></font><br></p>
<ol>
<li><p><strong> RAC(TARGET, [KEYPATH, [NIL_VALUE]])：</strong> 将一个对象的属性和一个signal绑定。</p>
<figure class="highlight lasso"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 只要文本框一改变，就会给account赋值</span></div><div class="line">    RAC(<span class="built_in">self</span>.viewModel.account, userName) = _nameTextField.rac_textSignal;</div></pre></td></tr></table></figure>
</li>
<li><p><strong> RACObserve(TARGET, KEYPATH)：</strong> 监听某个target的keypath属性，等效于KVO，并产生一个信号。</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//name只要有变化就给label重新赋值</span></div><div class="line">RAC(<span class="keyword">self</span>.Label, text) = RACObserve(<span class="keyword">self</span>.model, name);</div><div class="line"><span class="comment">// 将button与自己的enabled绑定 返回信号</span></div><div class="line">[RACObserve(<span class="keyword">self</span>.button, enabled) subscribeNext:^(<span class="keyword">id</span> x) &#123;</div><div class="line"></div><div class="line">	 <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>,x);</div><div class="line">&#125;];</div></pre></td></tr></table></figure>
</li>
<li><p><strong>@weakify(Obj)  @strongify(Obj)：</strong> 用在block内部管理对self的引用。一定是成双成对的出现。</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">weakify(<span class="keyword">self</span>)</div><div class="line">[RACObserve(<span class="keyword">self</span>.button, enabled) <span class="symbol">subscribeNext:</span>^(id x) &#123;</div><div class="line">	<span class="variable">@strongify</span>(<span class="keyword">self</span>)</div><div class="line">	</div><div class="line">&#125;];</div></pre></td></tr></table></figure>
</li>
<li><p><strong>RACTuplePack RACTupleUnpack</strong>：把数据包装成RACTuple元组类和把元组类解包成数据，前面类的时候提到过</p>
</li>
</ol>
<p><br><font color="orangeRed" size="4"><strong>小结</strong></font><br><br>究其本质核心就是signals，也就是bind（绑定），要慢慢转变之前OC的面向对象思维方式，处理相关事物的时候首先想到的就是绑定。基本大多数操作也都是围绕着信号进行的。研究了近一周RAC，到现在也只是理解了基本的概念，能用来简单的替换一些项目中的某些小功能，距离完全用RAC重构项目的路还有很长。接下来还会自己研究一下MVVM，之前做了一个没有RAC的MVVM的小demo，虽然viewController中的数据处理被分离到了viewModel中，但感觉没有RAC的MVVM就像没有花生米的宫保鸡丁，不完美！</p>
<p><br><font color="olivedrab" size="4"><strong>一月五号更新，关于信号的处理</strong></font><br></p>
<ol>
<li><p><strong> map：</strong> 一个简单的过滤，可以做一些小处理</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">    [[[RACSignal createSignal:^RACDisposable *(<span class="keyword">id</span>&lt;RACSubscriber&gt; subscriber) &#123;</div><div class="line">        </div><div class="line">        [subscriber sendNext:<span class="string">@"test"</span>];</div><div class="line">        [subscriber sendCompleted];</div><div class="line">        <span class="keyword">return</span> <span class="literal">nil</span>;</div><div class="line">    &#125;] map:^<span class="keyword">id</span>(<span class="built_in">NSString</span> *value) &#123;</div><div class="line">        </div><div class="line">        <span class="keyword">return</span> [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"map - %@"</span>, value];</div><div class="line">    &#125;]subscribeNext:^(<span class="keyword">id</span> x) &#123;</div><div class="line">        </div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, x);</div><div class="line">    &#125;];</div><div class="line"><span class="comment">// 打印</span></div><div class="line"><span class="number">2016</span><span class="number">-01</span><span class="number">-05</span> <span class="number">10</span>:<span class="number">54</span>:<span class="number">54.074</span> chaoxi[<span class="number">4474</span>:<span class="number">9984804</span>] map - test</div></pre></td></tr></table></figure>
</li>
<li><p><strong> filter：</strong> 一个加判断的过滤</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">    [[[RACSignal createSignal:^RACDisposable *(<span class="keyword">id</span>&lt;RACSubscriber&gt; subscriber) &#123;</div><div class="line">        </div><div class="line">        [subscriber sendNext:<span class="string">@"test"</span>];</div><div class="line">        [subscriber sendNext:<span class="string">@"filter-test"</span>];</div><div class="line">        [subscriber sendCompleted];</div><div class="line">        <span class="keyword">return</span> <span class="literal">nil</span>;</div><div class="line">    &#125;]filter:^<span class="built_in">BOOL</span>(<span class="built_in">NSString</span> *value) &#123;</div><div class="line">        </div><div class="line">        <span class="keyword">return</span> value.length&gt;<span class="number">5</span>;</div><div class="line">    &#125;]subscribeNext:^(<span class="keyword">id</span> x) &#123;</div><div class="line">    </div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, x);</div><div class="line">    &#125;];</div><div class="line"><span class="comment">// 打印出来的只有判断之后的</span></div><div class="line"><span class="number">2016</span><span class="number">-01</span><span class="number">-05</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">57.243</span> chaoxi[<span class="number">4711</span>:<span class="number">9993338</span>] filter-test</div></pre></td></tr></table></figure>
</li>
<li><p><strong> delay：</strong> 对信号的延时处理</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">	<span class="selector-attr">[[[RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;</span></div><div class="line"><span class="selector-attr">        </span></div><div class="line"><span class="selector-attr">		[subscriber sendNext:@"test"]</span>;</div><div class="line">		<span class="selector-attr">[subscriber sendCompleted]</span>;</div><div class="line">		<span class="selector-tag">NSLog</span>(@<span class="string">"--------begin-------"</span>);</div><div class="line">		<span class="selector-tag">return</span> <span class="selector-tag">nil</span>;</div><div class="line">	&#125;]<span class="selector-tag">delay</span><span class="selector-pseudo">:2</span>]<span class="selector-tag">subscribeNext</span>:^(id x) &#123;</div><div class="line">        </div><div class="line">		<span class="selector-tag">NSLog</span>(@<span class="string">"%@"</span>, x);</div><div class="line">	&#125;];</div><div class="line"><span class="comment">// 延时了两秒</span></div><div class="line"><span class="selector-tag">2016-01-05</span> <span class="selector-tag">11</span><span class="selector-pseudo">:17</span><span class="selector-pseudo">:16.635</span> <span class="selector-tag">chaoxi</span><span class="selector-attr">[5568:10011139]</span> <span class="selector-tag">--------begin-------</span></div><div class="line"><span class="selector-tag">2016-01-05</span> <span class="selector-tag">11</span><span class="selector-pseudo">:17</span><span class="selector-pseudo">:18.636</span> <span class="selector-tag">chaoxi</span><span class="selector-attr">[5568:10011139]</span> <span class="selector-tag">test</span></div></pre></td></tr></table></figure>
</li>
<li><p><strong> startWith: </strong> 先执行一次</p>
<figure class="highlight prolog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">    [[[<span class="symbol">RACSignal</span> createSignal:^<span class="symbol">RACDisposable</span> *(id&lt;<span class="symbol">RACSubscriber</span>&gt; subscriber) &#123;</div><div class="line">        </div><div class="line">        [subscriber sendNext:@<span class="string">"test"</span>];</div><div class="line">        [subscriber sendCompleted];</div><div class="line"></div><div class="line">        return nil;</div><div class="line">    &#125;]startWith:@<span class="string">"startWith"</span>]subscribeNext:^(id x) &#123;</div><div class="line">        </div><div class="line">        <span class="symbol">NSLog</span>(@<span class="string">"%@"</span>, x);</div><div class="line">    &#125;];</div><div class="line">// 打印</div><div class="line"><span class="number">2016</span><span class="number">-01</span><span class="number">-05</span> <span class="number">11</span>:<span class="number">15</span>:<span class="number">45.905</span> chaoxi[<span class="number">5363</span>:<span class="number">10007103</span>] startWith</div><div class="line"><span class="number">2016</span><span class="number">-01</span><span class="number">-05</span> <span class="number">11</span>:<span class="number">15</span>:<span class="number">45.906</span> chaoxi[<span class="number">5363</span>:<span class="number">10007103</span>] test</div></pre></td></tr></table></figure>
</li>
<li><p><strong> timeout: </strong> 超时，可以设置一段时间后自动报错</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">    <span class="string">[[[RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;</span></div><div class="line"><span class="string">        </span></div><div class="line"><span class="string">        return nil;</span></div><div class="line"><span class="string">    &#125;]timeout:2 onScheduler:[RACScheduler currentScheduler]]</span>subscribeNext:^(id x) &#123;</div><div class="line">        </div><div class="line">        NSLog(@<span class="string">"%@"</span>, x);</div><div class="line">    &#125;<span class="built_in">error</span>:^(NSError *<span class="built_in">error</span>) &#123;</div><div class="line">     </div><div class="line">        NSLog(@<span class="string">"%@"</span>, <span class="built_in">error</span>);</div><div class="line">    &#125;];</div><div class="line">// 这个信号没有被send所以<span class="number">2</span>秒后直接报错了</div><div class="line"><span class="number">2016</span><span class="number">-01</span><span class="number">-05</span> <span class="number">11</span>:<span class="number">30</span>:<span class="number">38.820</span> chaoxi[<span class="number">6564</span>:<span class="number">10033941</span>] Error Domain=RACSignalErrorDomain Code=<span class="number">1</span> <span class="string">"(null)"</span></div></pre></td></tr></table></figure>
</li>
<li><p><strong> take: </strong> 只执行前n次信号</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">    <span class="selector-attr">[[[RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;</span></div><div class="line"><span class="selector-attr"></span></div><div class="line"><span class="selector-attr">        [subscriber sendNext:@"biu-1"]</span>;</div><div class="line">        <span class="selector-attr">[subscriber sendNext:@"biu-2"]</span>;</div><div class="line">        <span class="selector-attr">[subscriber sendNext:@"biu-3"]</span>;</div><div class="line">        <span class="selector-attr">[subscriber sendNext:@"biu-4"]</span>;</div><div class="line">        <span class="selector-attr">[subscriber sendCompleted]</span>;</div><div class="line">        </div><div class="line">        <span class="selector-tag">return</span> <span class="selector-tag">nil</span>;</div><div class="line">    &#125;]<span class="selector-tag">take</span><span class="selector-pseudo">:2</span>] <span class="selector-tag">subscribeNext</span>:^(id x) &#123;</div><div class="line">        </div><div class="line">        <span class="selector-tag">NSLog</span>(@<span class="string">"-----------%@"</span>, x);</div><div class="line">    &#125;];</div><div class="line"><span class="comment">// 打印</span></div><div class="line"><span class="selector-tag">2016-01-05</span> <span class="selector-tag">11</span><span class="selector-pseudo">:33</span><span class="selector-pseudo">:48.057</span> <span class="selector-tag">chaoxi</span><span class="selector-attr">[6667:10037181]</span> <span class="selector-tag">-----------biu-1</span></div><div class="line"><span class="selector-tag">2016-01-05</span> <span class="selector-tag">11</span><span class="selector-pseudo">:33</span><span class="selector-pseudo">:48.058</span> <span class="selector-tag">chaoxi</span><span class="selector-attr">[6667:10037181]</span> <span class="selector-tag">-----------biu-2</span></div></pre></td></tr></table></figure>
</li>
<li><p><strong> takeLast: </strong> 和上面相反 只执行后几次信号</p>
</li>
<li><p><strong> takeUntilBlock: </strong> 执行到block中的内容位YES停止</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">    [[[RACSignal <span class="string">createSignal:</span>^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;</div><div class="line"></div><div class="line">        [subscriber <span class="string">sendNext:</span>@<span class="string">"biu-1"</span>];</div><div class="line">        [subscriber <span class="string">sendNext:</span>@<span class="string">"biu-2"</span>];</div><div class="line">        [subscriber <span class="string">sendNext:</span>@<span class="string">"biu-3"</span>];</div><div class="line">        [subscriber <span class="string">sendNext:</span>@<span class="string">"biu-4"</span>];</div><div class="line">        [subscriber sendCompleted];</div><div class="line">        <span class="keyword">return</span> nil;</div><div class="line">    &#125;]<span class="string">takeUntilBlock:</span>^BOOL(id x) &#123;</div><div class="line">        </div><div class="line">        <span class="keyword">return</span> [x <span class="string">isEqualToString:</span>@<span class="string">"biu-2"</span>];</div><div class="line">    &#125;] <span class="string">subscribeNext:</span>^(id x) &#123;</div><div class="line">        </div><div class="line">        NSLog(@<span class="string">"-----------%@"</span>, x);</div><div class="line">    &#125;];</div><div class="line"><span class="comment">// 只执行到了 biu-1</span></div><div class="line"><span class="number">2016</span><span class="number">-01</span><span class="number">-05</span> <span class="number">11</span>:<span class="number">35</span>:<span class="number">06.758</span> chaoxi[<span class="number">6732</span>:<span class="number">10038760</span>] -----------biu<span class="number">-1</span></div></pre></td></tr></table></figure>
</li>
<li><p><strong> takeWhileBlock: </strong> 和上面相反 当执行到block内位YES时开始取值</p>
</li>
<li><strong> takeUntil: </strong> 当给定的signal完成前一直取值 一般配合rac_willDeallocSignal 使用</li>
<li><strong> skip系列 </strong> 使用方法和take相似，skip跳过前几次；skipUntilBlock：一直跳，跳到block为yes时停止；skipWhileBlock：当位yes的时候开始跳。</li>
<li><p><strong> distinctUntilChanged </strong> 忽略连续两次相同的信号</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">    <span class="selector-attr">[[[RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;</span></div><div class="line"><span class="selector-attr"></span></div><div class="line"><span class="selector-attr">        [subscriber sendNext:@"biu-1"]</span>;</div><div class="line">        <span class="selector-attr">[subscriber sendNext:@"biu-1"]</span>;</div><div class="line">        <span class="selector-attr">[subscriber sendNext:@"biu-2"]</span>;</div><div class="line">        <span class="selector-attr">[subscriber sendCompleted]</span>;</div><div class="line">        <span class="selector-tag">return</span> <span class="selector-tag">nil</span>;</div><div class="line">    &#125;]<span class="selector-tag">distinctUntilChanged</span>] <span class="selector-tag">subscribeNext</span>:^(id x) &#123;</div><div class="line">        </div><div class="line">        <span class="selector-tag">NSLog</span>(@<span class="string">"-----------%@"</span>, x);</div><div class="line">    &#125;];</div><div class="line"><span class="comment">// 只执行了一次biu-1，第一次的被忽略</span></div><div class="line"><span class="selector-tag">2016-01-05</span> <span class="selector-tag">11</span><span class="selector-pseudo">:42</span><span class="selector-pseudo">:43.285</span> <span class="selector-tag">chaoxi</span><span class="selector-attr">[7046:10047680]</span> <span class="selector-tag">-----------biu-1</span></div><div class="line"><span class="selector-tag">2016-01-05</span> <span class="selector-tag">11</span><span class="selector-pseudo">:42</span><span class="selector-pseudo">:43.286</span> <span class="selector-tag">chaoxi</span><span class="selector-attr">[7046:10047680]</span> <span class="selector-tag">-----------biu-2</span></div></pre></td></tr></table></figure>
</li>
<li><p><strong> throttle： </strong> 忽略连续n秒内的值，也叫节流，一般应用在即时搜索中，忽略连续一段时间内的输入</p>
</li>
<li><strong> switchToLatest： </strong> signal of signal信号的信号。自动切换信号到最后一个</li>
<li><p><strong> ignore：</strong> 忽略指定的值</p>
<figure class="highlight prolog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">    [[[<span class="symbol">RACSignal</span> createSignal:^<span class="symbol">RACDisposable</span> *(id&lt;<span class="symbol">RACSubscriber</span>&gt; subscriber) &#123;</div><div class="line"></div><div class="line">        [subscriber sendNext:@<span class="string">"biu-1"</span>];</div><div class="line">        [subscriber sendNext:@<span class="string">"biu-2"</span>];</div><div class="line">        [subscriber sendNext:@<span class="string">"biu-3"</span>];</div><div class="line">        [subscriber sendCompleted];</div><div class="line">        return nil;</div><div class="line">    &#125;]ignore:@<span class="string">"biu-2"</span>] subscribeNext:^(id x) &#123;</div><div class="line">        </div><div class="line">        <span class="symbol">NSLog</span>(@<span class="string">"-----------%@"</span>, x);</div><div class="line">    &#125;];</div><div class="line">// biu<span class="number">-2</span> 被忽略</div><div class="line"><span class="number">2016</span><span class="number">-01</span><span class="number">-05</span> <span class="number">13</span>:<span class="number">59</span>:<span class="number">04.554</span> chaoxi[<span class="number">7535</span>:<span class="number">10110841</span>] -----------biu<span class="number">-1</span></div><div class="line"><span class="number">2016</span><span class="number">-01</span><span class="number">-05</span> <span class="number">13</span>:<span class="number">59</span>:<span class="number">04.555</span> chaoxi[<span class="number">7535</span>:<span class="number">10110841</span>] -----------biu<span class="number">-3</span></div></pre></td></tr></table></figure>
</li>
<li><p><strong> ignoreValues: </strong> 忽略所有值，只取Comletion和Error两个消息</p>
</li>
<li><p><strong> merge：</strong> 信号的合并处理, 合并信号后，合并之后的信号一旦被订阅，里面的所有信号都会被订阅。</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">    RACSignal *signalA = [RACSignal <span class="string">createSignal:</span>^RACDisposable *(id subscriber) &#123;</div><div class="line">        [subscriber <span class="string">sendNext:</span>@<span class="string">"signalA"</span>];</div><div class="line">        <span class="keyword">return</span> nil;</div><div class="line">    &#125;];</div><div class="line">    RACSignal *signalB = [RACSignal <span class="string">createSignal:</span>^RACDisposable *(id subscriber) &#123;</div><div class="line">        [subscriber <span class="string">sendNext:</span>@<span class="string">"signalB"</span>];</div><div class="line">        <span class="keyword">return</span> nil;</div><div class="line">    &#125;];</div><div class="line">    [[RACSignal <span class="string">merge:</span>@[signalA, signalB]] <span class="string">subscribeNext:</span>^(id x) &#123;</div><div class="line">        NSLog(@<span class="string">"我是%@"</span>,x);</div><div class="line">    &#125;];</div><div class="line"><span class="comment">// 打印</span></div><div class="line"><span class="number">2016</span><span class="number">-01</span><span class="number">-05</span> <span class="number">14</span>:<span class="number">26</span>:<span class="number">52.502</span> chaoxi[<span class="number">8092</span>:<span class="number">10146925</span>] 我是signalA</div><div class="line"><span class="number">2016</span><span class="number">-01</span><span class="number">-05</span> <span class="number">14</span>:<span class="number">26</span>:<span class="number">52.503</span> chaoxi[<span class="number">8092</span>:<span class="number">10146925</span>] 我是signalB</div></pre></td></tr></table></figure>
</li>
<li><p><strong> combineLatest/zipwith: </strong> 合并多个信号，每个合并的signal都有过一次sendNext才能触发合并的信号</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">    RACSignal *signalC = [RACSignal <span class="string">createSignal:</span>^RACDisposable *(id subscriber) &#123;</div><div class="line">        [subscriber <span class="string">sendNext:</span>@<span class="string">"signalC"</span>];</div><div class="line">        [subscriber <span class="string">sendNext:</span>@<span class="string">"signalCC"</span>];</div><div class="line">        <span class="keyword">return</span> nil;</div><div class="line">    &#125;];</div><div class="line">    RACSignal *signalD = [RACSignal <span class="string">createSignal:</span>^RACDisposable *(id subscriber) &#123;</div><div class="line">        [subscriber <span class="string">sendNext:</span>@<span class="string">"signalD"</span>];</div><div class="line">        <span class="keyword">return</span> nil;</div><div class="line">    &#125;];</div><div class="line">    [[RACSignal <span class="string">combineLatest:</span>@[signalC, signalD]] <span class="string">subscribeNext:</span>^(id x) &#123;</div><div class="line">        NSLog(@<span class="string">"%@"</span>, x);</div><div class="line">    &#125;];</div><div class="line">    [[signalC <span class="string">zipWith:</span> signalD] <span class="string">subscribeNext:</span>^(id x) &#123;</div><div class="line">       NSLog(@<span class="string">"%@"</span>, x);</div><div class="line">    &#125;];</div><div class="line"><span class="comment">// 打印出来是元组类，使用的话需要解包 combineLatest打印出来的是最新的值</span></div><div class="line"><span class="number">2016</span><span class="number">-01</span><span class="number">-05</span> <span class="number">14</span>:<span class="number">36</span>:<span class="number">31.428</span> chaoxi[<span class="number">8326</span>:<span class="number">10158523</span>] &lt;<span class="string">RACTuple:</span> <span class="number">0x7fa9a9422100</span>&gt; (</div><div class="line">    signalCC,</div><div class="line">    signalD</div><div class="line">)</div><div class="line"><span class="comment">// zipwith打印出来的是第一个值</span></div><div class="line"><span class="number">2016</span><span class="number">-01</span><span class="number">-05</span> <span class="number">14</span>:<span class="number">38</span>:<span class="number">02.467</span> chaoxi[<span class="number">8479</span>:<span class="number">10161310</span>] &lt;<span class="string">RACTuple:</span> <span class="number">0x7fc8c8d061c0</span>&gt; (</div><div class="line">    signalC,</div><div class="line">    signalD</div><div class="line">)</div></pre></td></tr></table></figure>
</li>
<li><p><strong> reduce: </strong> 聚合，把合并之后的两个信号的值聚合成一个值。</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">    RACSignal *signalA = [RACSignal createSignal:^RACDisposable *(<span class="keyword">id</span> subscriber) &#123;</div><div class="line">        [subscriber sendNext:<span class="string">@"signalA"</span>];</div><div class="line">        <span class="keyword">return</span> <span class="literal">nil</span>;</div><div class="line">    &#125;];</div><div class="line">    RACSignal *signalB = [RACSignal createSignal:^RACDisposable *(<span class="keyword">id</span> subscriber) &#123;</div><div class="line">        [subscriber sendNext:<span class="string">@"signalB"</span>];</div><div class="line">        <span class="keyword">return</span> <span class="literal">nil</span>;</div><div class="line">    &#125;];</div><div class="line">    [[RACSignal combineLatest:@[signalA, signalB] reduce:^<span class="keyword">id</span>(<span class="built_in">NSString</span> *A, <span class="built_in">NSString</span> *B)&#123;</div><div class="line">        </div><div class="line">        <span class="keyword">return</span> [A stringByAppendingString:B];</div><div class="line">    &#125;] subscribeNext:^(<span class="keyword">id</span> x) &#123;</div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"我是%@"</span>,x);</div><div class="line">    &#125;];</div><div class="line"><span class="comment">// 打印</span></div><div class="line"><span class="number">2016</span><span class="number">-01</span><span class="number">-05</span> <span class="number">14</span>:<span class="number">43</span>:<span class="number">52.968</span> chaoxi[<span class="number">8652</span>:<span class="number">10168574</span>] 我是signalAsignalB</div></pre></td></tr></table></figure>
</li>
<li><p><strong> concat: </strong> 有顺序的执行信号，当前一个信号执行完之后才执行下一个</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">    RACSignal *signalE = [RACSignal createSignal:^RACDisposable *(<span class="keyword">id</span> subscriber) &#123;</div><div class="line">        dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(<span class="number">3</span> * <span class="built_in">NSEC_PER_SEC</span>)), dispatch_get_main_queue(), ^&#123;</div><div class="line">            [subscriber sendNext:<span class="string">@"signalE"</span>];</div><div class="line">        &#125;);</div><div class="line">        <span class="keyword">return</span> <span class="literal">nil</span>;</div><div class="line">    &#125;];</div><div class="line">    RACSignal *signalF = [RACSignal createSignal:^RACDisposable *(<span class="keyword">id</span> subscriber) &#123;</div><div class="line">        [subscriber sendNext:<span class="string">@"signalF"</span>];</div><div class="line">        <span class="keyword">return</span> <span class="literal">nil</span>;</div><div class="line">    &#125;];</div><div class="line">    </div><div class="line">    [[signalE concat:signalF] subscribeNext:^(<span class="keyword">id</span> x) &#123;</div><div class="line">       </div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, x);</div><div class="line">    &#125;];</div><div class="line"><span class="comment">// 注意第一个信号我没有写 sendCompleted 所以最后只执行了第一个信号。</span></div><div class="line"><span class="number">2016</span><span class="number">-01</span><span class="number">-05</span> <span class="number">14</span>:<span class="number">51</span>:<span class="number">08.711</span> chaoxi[<span class="number">8939</span>:<span class="number">10178828</span>] signalE</div></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="暂时先更到这里"><a href="#暂时先更到这里" class="headerlink" title="暂时先更到这里"></a>暂时先更到这里</h2><p><br><font color="orangeRed" size="4"><strong>参考链接</strong></font><br></p>
<p><a href="http://www.raywenderlich.com/62699/reactivecocoa-tutorial-pt1" target="_blank" rel="external">http://www.raywenderlich.com/62699/reactivecocoa-tutorial-pt1</a><br><a href="http://www.raywenderlich.com/62796/reactivecocoa-tutorial-pt2" target="_blank" rel="external">http://www.raywenderlich.com/62796/reactivecocoa-tutorial-pt2</a><br><a href="https://github.com/AshFurrow/FunctionalReactivePixels" target="_blank" rel="external">https://github.com/AshFurrow/FunctionalReactivePixels</a><br><a href="https://github.com/jspahrsummers/GroceryList" target="_blank" rel="external">https://github.com/jspahrsummers/GroceryList</a><br><a href="http://limboy.me/ios/2013/06/19/frp-reactivecocoa.html" target="_blank" rel="external">http://limboy.me/ios/2013/06/19/frp-reactivecocoa.html</a></p>

      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2015/12/14/Method-Swizzing-Aspects/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption"><</strong>
      <div class="article-nav-title">
        
          黑科技 - Method Swizzling 与 Aspects
        
      </div>
    </a>
  
  
    <a href="/2015/10/26/HeaderDoc/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">HeaderDoc注释及文档生成</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>






<section id="comments">
  <div id="disqus_thread"></div>
    <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'chaoxn'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>

</div>
      <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
<script>
(function(){
    var bp = document.createElement('script');
    bp.src = '//push.zhanzhang.baidu.com/push.js';
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2019 潮汐
    	</div>
<span id="busuanzi_container_site_pv">
    您是第<span id="busuanzi_value_site_pv"></span>位访客
</span>
      	<div class="footer-right">
      		<a>ChaoX</a>
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>